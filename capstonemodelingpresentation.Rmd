---
title: "capstone modeling for presentation"
author: "Imogen Holdsworth"
date: "2024-12-02"
output: html_document

---

```{r}
# Confusion matrix data for stacked bar plot
confusion_data <- data.frame(
  Actual = rep(c("No Default", "Default"), each = 2),
  Predicted = rep(c("No Default", "Default"), 2),
  Count = c(207234, 0, 19649, 0) # Replace with actual confusion matrix counts
)

# Create the plot
confusion_plot <- ggplot(confusion_data, aes(x = Actual, y = Count, fill = Predicted)) +
  geom_bar(stat = "identity", position = "stack", width = 0.6) +
  scale_fill_manual(values = c("No Default" = "skyblue", "Default" = "salmon")) +
  labs(
    title = "Predicted vs. Actual Class Distribution",
    x = "Actual Class",
    y = "Count",
    fill = "Predicted Class"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5),
    axis.text.x = element_text(size = 12, face = "bold"),
    axis.text.y = element_text(size = 12),
    panel.grid.major = element_blank(),  # Remove major gridlines
    panel.grid.minor = element_blank()   # Remove minor gridlines
  )

# Save the plot as a PNG file
ggsave("confusion_matrix_plot_no_gridlines.png", plot = confusion_plot, width = 8, height = 6, dpi = 300)

```

```{r}

# Confusion matrix data for stacked bar plot
confusion_data <- data.frame(
  Actual = rep(c("No Default", "Default"), each = 2),
  Predicted = rep(c("No Default", "Default"), 2),
  Count = c(207234, 0, 19649, 0) # Replace with actual confusion matrix counts
)

# Create the plot
confusion_plot <- ggplot(confusion_data, aes(x = Actual, y = Count, fill = Predicted)) +
  geom_bar(stat = "identity", position = "stack", width = 0.6) +
  scale_fill_manual(values = c("No Default" = "mediumorchid3", "Default" = "plum2")) +
  labs(
    title = "Predicted vs. Actual Class Distribution",
    x = "Actual Class",
    y = "Count",
    fill = "Predicted Class"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5),
    axis.text.x = element_text(size = 12, face = "bold"),
    axis.text.y = element_text(size = 12),
    panel.grid.major = element_blank(),  # Remove major gridlines
    panel.grid.minor = element_blank()   # Remove minor gridlines
  )

# Save the plot as a PNG file
ggsave("confusion_matrix_plot_purple_no_gridlines.png", plot = confusion_plot, width = 8, height = 6, dpi = 300)


```

```{r}


library(ggplot2)

# Metrics for both models, including AUC
model_comparison <- data.frame(
  Metric = rep(c("Recall", "Precision", "F1 Score", "AUC"), 2),
  Value = c(0.006, 0.552, 0.011, 0.7513, 0.47, 0.2269, 0.3054, 0.7465), # Values for original & upsampled
  Model = rep(c("Original XGBoost", "Upsampled XGBoost"), each = 4)
)

# Create the plot
plot <- ggplot(model_comparison, aes(x = Metric, y = Value, fill = Model)) +
  geom_bar(stat = "identity", position = position_dodge(), width = 0.7) +
  scale_fill_manual(values = c("Original XGBoost" = "red", "Upsampled XGBoost" = "pink")) +
  labs(
    title = "XGBoost Performance Metrics: Original vs. Upsampled",
    x = "Metric",
    y = "Value",
    fill = "Model"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5),
    axis.text.x = element_text(size = 12, face = "bold"),
    axis.text.y = element_text(size = 10, face = "bold"),
    panel.grid.major = element_blank(),   # Remove major gridlines
    panel.grid.minor = element_blank(),   # Remove minor gridlines
    panel.background = element_blank()    # Ensure no background grid
  ) +
  geom_text(
    aes(label = round(Value, 3)),
    position = position_dodge(0.7),
    vjust = -0.5,
    size = 4
  )

# Save the plot as a PNG
ggsave("model_performance_metrics_with_auc.png", plot = plot, width = 8, height = 6, dpi = 300)

# Display the plot
plot

```

```{r}
# Create a data frame for the distribution
target_distribution <- data.frame(
  Target = c("No Default", "Default"),
  Proportion = c(0.91339307, 0.08660693)
)

# Plot the distribution
ggplot(target_distribution, aes(x = Target, y = Proportion, fill = Target)) +
  geom_bar(stat = "identity", width = 0.6, color = "black") +
  scale_fill_manual(values = c("No Default" = "purple", "Default" = "orange")) +
  geom_text(aes(label = scales::percent(Proportion)), vjust = -0.5, size = 5) +
  labs(
    title = "Distribution of TARGET Variable",
    x = "Target Class",
    y = "Proportion",
    fill = "Target"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 12),
    legend.position = "none"
  ) +
  ylim(0, 1) # Ensure the y-axis goes up to 1
```

```{r}
# Load necessary libraries
library(ggplot2)

# Create a data frame for the distribution
target_distribution <- data.frame(
  Target = c("No Default", "Default"),
  Proportion = c(0.91339307, 0.08660693)
)

# Save the plot as a PNG
png("target_variable_distribution_fixed.png", width = 1200, height = 900, res = 300)

# Plot the distribution
ggplot(target_distribution, aes(x = Target, y = Proportion, fill = Target)) +
  geom_bar(stat = "identity", width = 0.6, color = "black") +
  scale_fill_manual(values = c("No Default" = "skyblue", "Default" = "salmon")) +
  geom_text(
    aes(label = paste0(round(Proportion * 100, 1), "%")),
    vjust = -0.5, size = 4, fontface = "bold"
  ) + # Adjusted text size and position
  labs(
    title = "Distribution of Target Variable",
    x = "Target Class",
    y = "Proportion",
    fill = "Target"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 12),
    legend.position = "none",
    panel.grid = element_blank() # Removes gridlines
  ) +
  ylim(0, 1.1) # Added padding above bars to prevent text cutoff

# Close the PNG device
dev.off()



```

